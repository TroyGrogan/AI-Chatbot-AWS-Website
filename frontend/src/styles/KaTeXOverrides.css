/* 
 * KaTeX Overrides CSS
 * This file contains critical overrides for the KaTeX library to fix common rendering issues,
 * especially for matrices and complex math expressions.
 */

/* Global KaTeX overrides */
.katex {
  white-space: normal !important;
  max-width: 100% !important;
  overflow: visible !important;
  word-break: normal !important;
  word-wrap: break-word !important;
}

.katex-display {
  overflow-x: visible !important;
  overflow-y: visible !important;
  white-space: normal !important;
  max-width: 100% !important;
  padding: 0.5em 0 !important;
  margin: 1em 0 !important;
}

.katex-html {
  overflow: visible !important;
  white-space: normal !important;
  max-width: 100% !important;
}

/* Fix matrix rendering issues */
.katex .mtable {
  overflow: visible !important;
  max-width: 100% !important;
  white-space: normal !important;
  margin: 0 auto !important;
}

.katex .mtable .mtr {
  display: table-row !important;
  max-width: 100% !important;
}

.katex .mtable .mtd {
  display: table-cell !important;
  max-width: none !important;
  padding: 0.2em 0.5em !important;
  text-align: center !important;
  vertical-align: middle !important;
}

/* Fix bracket sizing for matrices */
.katex .delimsizing {
  overflow: visible !important;
}

.katex .delimsizing.mult {
  overflow: visible !important;
}

/* Fix for vlist issues in matrices */
.katex .vlist {
  overflow: visible !important;
}

.katex .vlist-t {
  overflow: visible !important;
}

.katex .vlist-r {
  overflow: visible !important;
}

/* Fix for horizontal lines in fractions */
.katex .mfrac .frac-line {
  min-width: auto !important;
  width: 100% !important;
}

/* Fix for large operators */
.katex .mop {
  overflow: visible !important;
}

/* Fix for any scrollbar that might appear */
.message-content ::-webkit-scrollbar {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}

.message-content {
  -ms-overflow-style: none !important;  /* IE and Edge */
  scrollbar-width: none !important;  /* Firefox */
}

/* Fix for math processor containers */
.math-processor {
  overflow: visible !important;
  max-width: 100% !important;
  width: 100% !important;
  white-space: normal !important;
}

/* Fix for math content in AI messages */
.ai .message-content {
  overflow: visible !important;
  max-width: 100% !important;
}

/* Fix for 'slidebox' effect in matrix containers */
.math-block-container {
  overflow: visible !important;
  max-width: 100% !important;
  width: 100% !important;
  display: block !important;
  margin: 1em 0 !important;
}

/* For specific matrix layouts */
.contains-matrix .katex .mtable {
  table-layout: auto !important;
  border-collapse: separate !important;
  border-spacing: 1px !important;
}

/* Ensure display math has proper spacing */
.math-block {
  overflow: visible !important;
  max-width: 100% !important;
  width: 100% !important;
  margin: 1em 0 !important;
  padding: 0.5em 0 !important;
  display: block !important;
}

/* Ensure inline math doesn't cause line breaks */
.math-inline {
  overflow: visible !important;
  display: inline-flex !important;
  align-items: center !important;
  vertical-align: middle !important;
  max-width: 100% !important;
}

/* Prevent non-LaTeX content from being rendered as math */
.message-content p {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif !important;
}

/* Ensure text content doesn't get KaTeX styling */
.text-content {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif !important;
}

/* Add clear visual boundaries for math content */
.math-block-container {
  background-color: rgba(248, 250, 252, 0.4) !important;
  border-radius: 4px !important;
  padding: 8px !important;
  margin: 12px 0 !important;
}

/* Apply math font only to actual math elements */
.katex, .katex-display, .katex-html {
  font-family: KaTeX_Main, 'Times New Roman', serif !important;
} 